_format_version: "3.0"
_transform: true

_info:
  select_tags:
  - rag_ret
_konnect:
  control_plane_name: tcsai


services:
  # Document Embedding Service
  - name: doc-embedder-service
    url: http://localhost:8080
    routes:
      - name: embed-route
        paths:
          - /v1/embedd
        methods:
          - POST
    plugins:
      - name: doc-embedder
        config:
          azure_endpoint: "https://btgazureopenai.openai.azure.com"
          deployment: "BTG_text-embedding-ada-002"
          api_version: "2025-01-01-preview"
          azure_api_key: "b7a813d6bdd8487c954991961f6d174e"
          redis_url: "redis://default:ie5sXEVDGqZcpf8T3secGPGc3z8FB8aF@redis-15934.crce206.ap-south-1-1.ec2.redns.redis-cloud.com:15934"
          redis_index: "hr_mitr_index"
          redis_prefix: "doc:"
          chunk_size: 500
          chunk_overlap: 50
          max_chunks: 50
          embedding_dim: 1536

  # RAG Retrieval Service
  - name: rag-retrieval-service
    url: http://localhost:8080
    routes:
      - name: rag-route
        paths:
          - /v1/rag
        methods:
          - POST
    plugins:
      - name: rag-retriever
        config:
          azure_endpoint: "https://btgazureopenai.openai.azure.com"
          deployment: "BTG_text-embedding-ada-002"
          api_version: "2025-01-01-preview"
          azure_api_key: "b7a813d6bdd8487c954991961f6d174e"
          redis_url: "redis://default:ie5sXEVDGqZcpf8T3secGPGc3z8FB8aF@redis-15934.crce206.ap-south-1-1.ec2.redns.redis-cloud.com:15934"
          redis_index: "hr_mitr_index"
          redis_prefix: "doc:"
          embedding_dim: 1536
          top_k: 5
          similarity_threshold: 0.7

